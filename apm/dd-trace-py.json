{
  "url": "https://api.github.com/repos/DataDog/dd-trace-py/releases/275596034",
  "assets_url": "https://api.github.com/repos/DataDog/dd-trace-py/releases/275596034/assets",
  "upload_url": "https://uploads.github.com/repos/DataDog/dd-trace-py/releases/275596034/assets{?name,label}",
  "html_url": "https://github.com/DataDog/dd-trace-py/releases/tag/v4.2.0",
  "id": 275596034,
  "author": {
    "login": "emmettbutler",
    "id": 723615,
    "node_id": "MDQ6VXNlcjcyMzYxNQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/723615?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/emmettbutler",
    "html_url": "https://github.com/emmettbutler",
    "followers_url": "https://api.github.com/users/emmettbutler/followers",
    "following_url": "https://api.github.com/users/emmettbutler/following{/other_user}",
    "gists_url": "https://api.github.com/users/emmettbutler/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/emmettbutler/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/emmettbutler/subscriptions",
    "organizations_url": "https://api.github.com/users/emmettbutler/orgs",
    "repos_url": "https://api.github.com/users/emmettbutler/repos",
    "events_url": "https://api.github.com/users/emmettbutler/events{/privacy}",
    "received_events_url": "https://api.github.com/users/emmettbutler/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "node_id": "RE_kwDOA6uE5s4QbUMC",
  "tag_name": "v4.2.0",
  "target_commitish": "4.2.0-temp",
  "name": "4.2.0",
  "draft": false,
  "immutable": false,
  "prerelease": false,
  "created_at": "2026-01-09T19:40:21Z",
  "updated_at": "2026-01-09T19:41:30Z",
  "published_at": "2026-01-09T19:41:30Z",
  "assets": [

  ],
  "tarball_url": "https://api.github.com/repos/DataDog/dd-trace-py/tarball/v4.2.0",
  "zipball_url": "https://api.github.com/repos/DataDog/dd-trace-py/zipball/v4.2.0",
  "body": "Estimated end-of-life date, accurate to within three months: 05-2027\r\nSee [the support level definitions](https://docs.datadoghq.com/tracing/trace_collection/compatibility/python/#releases) for more information.\r\n\r\n### Upgrade Notes\r\n\r\n- tracing\r\n  - The `Hooks` class (`config.<integration>.hooks`) is deprecated and will be removed in v5.0. All hook methods (`register()`, `on()`, `deregister()`, `emit()`) are now no-op and no longer affect span behavior. To interact with spans, use `ddtrace.trace_utils.get_current_span()` or `ddtrace.trace_utils.get_current_root_span()` instead.\r\n\r\n### New Features\r\n\r\n- LLM Observability\r\n  - Adds tracing of `initialize` requests and their responses on modelcontextprotocol/python-sdk servers.\r\n  - This introduces automatic `source:otel` tagging for evaluations when OpenTelemetry (OTel) tracing is enabled when `DD_TRACE_OTEL_ENABLED=true` is set. This tag allows the backend to wait for OTel span conversion before processing evaluations.\r\n  - Changes format of MCP server tool call span input, output, and tags to include the full request and response objects.\r\n  - Reasoning token counts are now captured from VertexAI responses.\r\n  - Adds ability to automatically capture the intent and context of an MCP server tool call to modelcontextprotocol/python-sdk servers using the `DD_MCP_CAPTURE_INTENT` environment variable.\r\n- profiling\r\n  - Add support for `asyncio.BoundedSemaphore` lock type profiling in Python Lock Profiler.\r\n  - Add support for `asyncio.Condition` locking type profiling in Python. The Lock profiler now provides visibility into `asyncio.Condition` usage, helping identify contention in async applications using condition variables.\r\n  - Add support for `asyncio.Semaphore` lock type profiling in Python Lock Profiler.\r\n  - the Profiler now properly stacks flame graphs for Tasks awaiting and awaited through `asyncio.shield`.\r\n  - the Profiler now tracks Tasks created through `asyncio.TaskGroup`.\r\n- AAP\r\n  - Add business logic event detection for Stripe. This feature instruments the payment intent and checkout session creation actions as well as the payment_intent.succeeded, payment_intent.payment_failed and payment_intent.canceled events.\r\n  - Proxy inferred spans now contain events when AppSec is enabled so that they are reported on the App and API Protection Endpoint Catalog.\r\n- DBM\r\n  - Adds container tags support\r\n- DSM\r\n  - Adds container tags support\r\n- tracing\r\n  - Proxy inferred spans now differentiate between API Gateway v1 and v2 apis by emitting the `aws.httpapi` span name for v2 apis when the API Gateway sets the `x-dd-proxy` header to `aws-httpapi`. Additionally, the tag `http.route` and the resource name of the span now contains the api resource path instead of the path when propagated with the `x-dd-proxy-resource-path` header.\r\n- vllm\r\n  - Introduces tracing and LLM Observability support for vLLM V1 engine. Requires vLLM \\>= 0.10.2. See [the docs](https://ddtrace.readthedocs.io/en/stable/integrations.html#vllm) for more information.\r\n\r\n### Bug Fixes\r\n\r\n- CI Visibility\r\n  - This fix resolves an issue where code coverage instrumentation in Python 3.9 would raise an exception while handling line numbers in some corner cases.\r\n- crash tracking\r\n  - Passing in all environment variables to the crashtracker receiver process caused conflicts with export location derivation. This change only passes in the DD_CRASHTRACKING_ERRORS_INTAKE_ENABLED environment variable.\r\n- falcon\r\n  - Fixes `DD_TRACE_REMOVE_INTEGRATION_SERVICE_NAMES_ENABLED` support, which was previously ignored.\r\n- tracing\r\n  - Proxy inferred spans used to omit the `https://` scheme prefix as part of the `http.url` tag; this caused the entire url to be parsed as the http path.\r\n  - psycopg\r\n    - Fixes an OperationalError that occurred when patching a closed psycopg3 connection.\r\n- dynamic instrumentation\r\n  - fixed an issue that caused condition expressions containing `isDefined` to result in an evaluation error.\r\n  - fixed an issue that prevented autocomplete information to be extracted from the running application.\r\n- openfeature\r\n  - This fix resolves an issue where Feature Flagging and Experimentation (FFE) was not receiving remote configuration in forking web server environments (gunicorn, uWSGI). This caused the OpenFeature provider to return default values instead of configured feature flags. FFE is now properly registered as a product during tracer initialization (when `DD_EXPERIMENTAL_FLAGGING_PROVIDER_ENABLED=true`), ensuring remote configuration is received before process forking occurs.\r\n  - Fix exposure event deduplication to use (flag_key, subject_id) as cache key instead of (flag_key, variant_key, allocation_key). This ensures different users each receive their own exposure event while still deduplicating repeated evaluations for the same user. Also adds LRU eviction to prevent unbounded memory growth and respects the do_log flag from flag metadata.\r\n- ray\r\n - This fix resolves an issue where `None` metadata in Ray job submission caused a crash.\r\n- openai_agents\r\n  - This fix resolves an issue where a missing active span caused an `AttributeError` when calling `tag_agent_manifest`.\r\n- LLM Observability\r\n  - This fix resolves an issue where using multiple sequential `annotation_context` blocks caused annotations to fail after the first operation in subsequent contexts. Previously, the trace context created by the first `annotation_context` remained active after exiting, causing the second context to reuse a stale context ID. This resulted in annotations not being applied to spans after the first batch call in the second `annotation_context` block.\r\n  - Resolves an issue in `activate_distributed_headers()` where distributed requests missing a LLM Observability trace ID would be incorrectly propagated twice.\r\n- profiling\r\n  - This fix resolves an issue where memory profiler module fails to load when the system doesn't have libatomic installed.\r\n  - This fix resolves an issue where the Lock profiler would not call the necessary initialization function, which would sometimes result in crashes.\r\n  - the Profiler now always uses the name of leaf tasks for the \"Task name\" label. Previously, one of the Stacks would be labelled with the parent task's name, which would lead to inconsistent behaviour across runs.\r\n  - Fixes a bug where code that sub-classes our wrapped locks crashes with `TypeError` during profiling. One example of this is neo4j's `AsyncRLock`, which inherits from `asyncio.Lock`: <https://github.com/neo4j/neo4j-python-driver/blob/6.x/src/neo4j/_async_compat/concurrency.py#L45>\r\n  - a bug causing crashes when using `uvloop` and forking has been resolved.\r\n  - This improves the accuracy of stacks for on-CPU asyncio Tasks by reducing the odds of Frames for a Task polluting the stack of other Tasks.\r\n  - the build now uses the correct location for the native extension module. Previously, linking would work correctly in tests, but published wheels failed to import the memory profiler extension.\r\n- SSI\r\n  - This fixes an issue where ddtrace fails to find `_psutil_linux.abi3.so` file in an injected environment.\r\n"
}
